"use strict";(self["webpackChunkfurniture_project"]=self["webpackChunkfurniture_project"]||[]).push([[987],{6987:function(t,e,s){s.r(e),s.d(e,{default:function(){return X}});var r=s(6768),a=s(4232);const l={class:"my-5"},o={class:"container"},i={class:"border p-3 p-md-5"},d={class:"row justify-content-center"},c={class:"col-12 col-lg-8 py-3 table-responsive"},n={class:"table align-middle mt-3"},u={class:"text-nowrap"},h={class:"text-end"},L={class:"text-end"},k={class:"text-end"},p={class:"w-100"},m={class:"border-top"},b={class:"text-end w-50"},g={class:"col-12 col-lg-8 mt-3 table-responsive"},v={class:"table border mt-3"},x={class:"text-nowrap"},y={key:0,class:"text-secondary"},f={key:1,class:"text-success"},_={key:0,class:"text-end"};function w(t,e,s,w,C,$){const I=(0,r.g2)("LoadingOverlay");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(I,{active:C.isLoading},null,8,["active"]),(0,r.Lk)("div",l,[(0,r.Lk)("div",o,[(0,r.Lk)("div",i,[(0,r.Lk)("div",d,[(0,r.Lk)("form",c,[e[3]||(e[3]=(0,r.Lk)("h2",{class:"fs-3"},"購物清單",-1)),(0,r.Lk)("table",n,[e[1]||(e[1]=(0,r.Lk)("thead",{class:"table-bg text-custom text-nowrap"},[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"品名"),(0,r.Lk)("th",{class:"text-end"},"單價"),(0,r.Lk)("th",{class:"text-end"},"數量"),(0,r.Lk)("th",{class:"text-end"},"小計")])],-1)),(0,r.Lk)("tbody",u,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(C.order.products,(e=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,a.v_)(e.product.title),1),(0,r.Lk)("td",h,(0,a.v_)(t.$filters.currency(e.product.price)),1),(0,r.Lk)("td",L,(0,a.v_)(e.qty)+" / "+(0,a.v_)(e.product.unit),1),(0,r.Lk)("td",k,(0,a.v_)(t.$filters.currency(e.total)),1)])))),128))])]),(0,r.Lk)("table",p,[(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",m,[e[2]||(e[2]=(0,r.Lk)("td",{class:"text-end py-2"},"總計金額",-1)),(0,r.Lk)("td",b,"NT$ "+(0,a.v_)(t.$filters.currency(C.order.total)),1)])])])]),(0,r.Lk)("form",g,[e[9]||(e[9]=(0,r.Lk)("h2",{class:"fs-3 text-custom"},"收件人資料",-1)),(0,r.Lk)("table",v,[(0,r.Lk)("tbody",x,[(0,r.Lk)("tr",null,[e[4]||(e[4]=(0,r.Lk)("th",{width:"100",class:"table-bg text-custom"},"Email",-1)),(0,r.Lk)("td",null,(0,a.v_)(C.order.user.email),1)]),(0,r.Lk)("tr",null,[e[5]||(e[5]=(0,r.Lk)("th",{class:"table-bg text-custom"},"姓名",-1)),(0,r.Lk)("td",null,(0,a.v_)(C.order.user.name),1)]),(0,r.Lk)("tr",null,[e[6]||(e[6]=(0,r.Lk)("th",{class:"table-bg text-custom"},"收件人電話",-1)),(0,r.Lk)("td",null,(0,a.v_)(C.order.user.tel),1)]),(0,r.Lk)("tr",null,[e[7]||(e[7]=(0,r.Lk)("th",{class:"table-bg text-custom"},"收件人地址",-1)),(0,r.Lk)("td",null,(0,a.v_)(C.order.user.address),1)]),(0,r.Lk)("tr",null,[e[8]||(e[8]=(0,r.Lk)("th",{class:"table-bg text-custom"},"付款狀態",-1)),(0,r.Lk)("td",null,[C.order.is_paid?((0,r.uX)(),(0,r.CE)("span",f,"付款完成")):((0,r.uX)(),(0,r.CE)("span",y,"尚未付款"))])])])]),!1===C.order.is_paid?((0,r.uX)(),(0,r.CE)("div",_,[(0,r.Lk)("button",{type:"button",onClick:e[0]||(e[0]=(...t)=>$.payOrder&&$.payOrder(...t)),class:"btn btn-outline-custom"},"確認付款")])):(0,r.Q3)("",!0)])])])])])],64)}s(4114);var C=s(1735),$=s.n(C),I={data(){return{cart:{},order:{user:{}},deliveryFee:0,orderId:"",isLoading:!1}},inject:{emitter:["emitter"]},methods:{getOrder(){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/wei8891-api/order/${this.orderId}`;this.$http.get(t).then((t=>{t.data.success&&(console.log("order:",t.data.order),this.isLoading=!1,this.order=t.data.order,this.getCart())}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/wei8891-api/cart";this.$http.get(t).then((t=>{t.data.success&&(console.log("cart:",t.data.data),console.log("cart.total:",t.data.data.total),console.log("cart.final_total:",t.data.data.final_total),this.cart=t.data.data)}))},payOrder(){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/wei8891-api/pay/${this.orderId}`;setTimeout((()=>{this.$http.post(t).then((t=>{if(t.data.success){let t;this.isLoading=!1,this.emitter.emit("update-cart",this.cart.carts.id),$().fire({icon:"success",title:"付款完成！",html:"將於 <b></b> 秒後關閉",timer:3e3,didOpen:()=>{$().showLoading();const e=$().getHtmlContainer().querySelector("b");t=setInterval((()=>{e.textContent=parseInt($().getTimerLeft()/1e3,10)}),100)},willClose:()=>{clearInterval(t)}}).then((t=>{t.dismiss===$().DismissReason.timer&&this.$router.push("/productList")})),this.getOrder()}else this.isLoading=!1,$().fire({icon:"error",title:"付款失敗！",showConfirmButton:!1,timer:1500}),this.getOrder()}))}),2e3)}},created(){this.isLoading=!0,setTimeout((()=>{this.orderId=this.$route.params.orderId,this.getOrder(),this.isLoading=!1}),2e3)}},O=s(1241);const E=(0,O.A)(I,[["render",w]]);var X=E}}]);
//# sourceMappingURL=987.ad3881cb.js.map